{% extends "base.xhtml" %}

{% block title %}Mi Perfil{% endblock %}

{% block content %}
<section class="py-24 bg-background-light dark:bg-slate-950 min-h-[70vh]">
    <div class="container mx-auto px-6">
        <div class="max-w-4xl mx-auto">
            <!-- Header -->
            <div class="flex items-center justify-between mb-8 flex-wrap gap-4">
                <div>
                    <h1 class="font-display text-3xl font-bold text-slate-900 dark:text-white mb-2">Mi Perfil</h1>
                    <p class="text-slate-500 dark:text-slate-400">Hola, {{ current_user.name.split()[0] }}! Acá podés
                        administrar tu información.</p>
                </div>
                <a href="{{ url_for('auth.logout') }}"
                    class="inline-flex items-center gap-2 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-300 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                    <span class="material-symbols-outlined text-sm">logout</span>
                    Cerrar sesión
                </a>
            </div>

            <!-- Flash messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            {% for category, message in messages %}
            <div
                class="mb-6 px-4 py-3 rounded-lg {% if category == 'error' %}bg-red-50 text-red-700 border border-red-200{% elif category == 'success' %}bg-green-50 text-green-700 border border-green-200{% else %}bg-blue-50 text-blue-700 border border-blue-200{% endif %} text-sm">
                {{ message }}
            </div>
            {% endfor %}
            {% endif %}
            {% endwith %}

            <div class="grid md:grid-cols-3 gap-8">
                <!-- Sidebar / Profile Preview -->
                <div class="md:col-span-1">
                    <div
                        class="bg-white dark:bg-slate-900 rounded-2xl p-6 shadow-sm border border-slate-100 dark:border-slate-800 text-center">
                        <div class="w-24 h-24 mx-auto rounded-full overflow-hidden bg-slate-100 dark:bg-slate-800 mb-4">
                            {% if current_user.photo %}
                            <img src="{{ url_for('static', filename='img/profiles/' ~ current_user.photo) }}"
                                alt="{{ current_user.name }}" class="w-full h-full object-cover"
                                onerror="this.parentElement.innerHTML='<span class=\'material-symbols-outlined text-5xl text-slate-300 dark:text-slate-600 flex items-center justify-center h-full\'>account_circle</span>'" />
                            {% else %}
                            <span
                                class="material-symbols-outlined text-5xl text-slate-300 dark:text-slate-600 flex items-center justify-center h-full">account_circle</span>
                            {% endif %}
                        </div>
                        <h2 class="font-display text-lg font-bold text-slate-900 dark:text-white mb-1">{{
                            current_user.name }}</h2>
                        <p class="text-primary text-sm font-medium mb-4">{{ current_user.position or current_user.degree
                            or 'Miembro del grupo' }}</p>

                        <a href="{{ url_for('main.miembro_detalle', slug=current_user.slug) }}"
                            class="inline-flex items-center gap-1 text-slate-500 hover:text-primary text-sm transition-colors">
                            <span class="material-symbols-outlined text-sm">visibility</span>
                            Ver perfil público
                        </a>
                    </div>

                    <!-- Quick Links -->
                    <div
                        class="bg-white dark:bg-slate-900 rounded-2xl p-6 shadow-sm border border-slate-100 dark:border-slate-800 mt-6">
                        <h3 class="font-semibold text-slate-900 dark:text-white mb-4">Acciones rápidas</h3>
                        <ul class="space-y-3">
                            <li>
                                <a href="{{ url_for('auth.edit_profile') }}"
                                    class="flex items-center gap-3 text-slate-600 dark:text-slate-400 hover:text-primary transition-colors text-sm">
                                    <span class="material-symbols-outlined text-lg">edit</span>
                                    Editar información
                                </a>
                            </li>
                            <li>
                                <a href="{{ url_for('main.equipo') }}"
                                    class="flex items-center gap-3 text-slate-600 dark:text-slate-400 hover:text-primary transition-colors text-sm">
                                    <span class="material-symbols-outlined text-lg">group</span>
                                    Ver todo el equipo
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="md:col-span-2">
                    <div
                        class="bg-white dark:bg-slate-900 rounded-2xl p-8 shadow-sm border border-slate-100 dark:border-slate-800">
                        <h2
                            class="font-display text-xl font-bold text-slate-900 dark:text-white mb-6 flex items-center gap-2">
                            <span class="material-symbols-outlined text-primary">person</span>
                            Información actual
                        </h2>

                        <dl class="space-y-6">
                            <div class="grid grid-cols-3 gap-4 py-3 border-b border-slate-100 dark:border-slate-800">
                                <dt class="text-sm font-medium text-slate-500">Nombre completo</dt>
                                <dd class="col-span-2 text-sm text-slate-900 dark:text-white">{{ current_user.name }}
                                </dd>
                            </div>
                            <div class="grid grid-cols-3 gap-4 py-3 border-b border-slate-100 dark:border-slate-800">
                                <dt class="text-sm font-medium text-slate-500">Email</dt>
                                <dd class="col-span-2 text-sm text-slate-900 dark:text-white">{{ current_user.email }}
                                </dd>
                            </div>
                            <div class="grid grid-cols-3 gap-4 py-3 border-b border-slate-100 dark:border-slate-800">
                                <dt class="text-sm font-medium text-slate-500">Título/Grado</dt>
                                <dd class="col-span-2 text-sm text-slate-900 dark:text-white">{{ current_user.degree or
                                    '—' }}</dd>
                            </div>
                            <div class="grid grid-cols-3 gap-4 py-3 border-b border-slate-100 dark:border-slate-800">
                                <dt class="text-sm font-medium text-slate-500">Cargo/Posición</dt>
                                <dd class="col-span-2 text-sm text-slate-900 dark:text-white">{{ current_user.position
                                    or '—' }}</dd>
                            </div>
                            <div class="grid grid-cols-3 gap-4 py-3 border-b border-slate-100 dark:border-slate-800">
                                <dt class="text-sm font-medium text-slate-500">LinkedIn</dt>
                                <dd class="col-span-2 text-sm text-slate-900 dark:text-white">
                                    {% if current_user.linkedin %}
                                    <a href="{{ current_user.linkedin }}" target="_blank"
                                        class="text-primary hover:underline">{{ current_user.linkedin }}</a>
                                    {% else %}
                                    —
                                    {% endif %}
                                </dd>
                            </div>
                            <div class="grid grid-cols-3 gap-4 py-3">
                                <dt class="text-sm font-medium text-slate-500">Biografía</dt>
                                <dd class="col-span-2 text-sm text-slate-900 dark:text-white">{{ current_user.bio or
                                    'Sin biografía' }}</dd>
                            </div>
                        </dl>

                        <div class="mt-8 pt-6 border-t border-slate-100 dark:border-slate-800">
                            <a href="{{ url_for('auth.edit_profile') }}"
                                class="inline-flex items-center gap-2 bg-primary hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-medium transition-all">
                                <span class="material-symbols-outlined">edit</span>
                                Editar mi perfil
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}